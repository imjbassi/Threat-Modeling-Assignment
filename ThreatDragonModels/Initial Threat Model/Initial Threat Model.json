{
  "version": "2.4.1",
  "summary": {
    "title": "Initial Threat Model",
    "owner": "imjbassi",
    "description": "This is a basic web message board application that allows users to log in, view a message of the day, and leave comments. Authentication is handled by an open-source component, and all user data is stored in a backend database.",
    "id": 0
  },
  "detail": {
    "contributors": [],
    "diagrams": [
      {
        "id": 0,
        "title": "Initial Threat Model Diagram",
        "diagramType": "STRIDE",
        "placeholder": "New STRIDE diagram description",
        "thumbnail": "./public/content/images/thumbnail.stride.jpg",
        "version": "2.4.1",
        "cells": [
          {
            "position": {
              "x": 429.99999999999955,
              "y": 100.00000000000193
            },
            "size": {
              "width": 570,
              "height": 220
            },
            "visible": true,
            "shape": "trust-boundary-box",
            "id": "ad975a41-5cdb-448b-96a4-84591be98711",
            "zIndex": -1,
            "data": {
              "type": "tm.BoundaryBox",
              "name": "Trust Boundary",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            }
          },
          {
            "position": {
              "x": 130,
              "y": 130
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "User (Browser)"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "40c14139-bbbf-41e1-ba18-47898d0cc715"
                },
                {
                  "group": "right",
                  "id": "8f0e8f65-1a08-4547-815a-08be7d71e7df"
                },
                {
                  "group": "bottom",
                  "id": "f89494f5-9db5-45c5-ac49-58709023aa21"
                },
                {
                  "group": "left",
                  "id": "f9369963-337d-4ea2-81f7-4d27bee4bdfa"
                }
              ]
            },
            "id": "292d9e57-7f74-475d-b31a-206fb6a0e821",
            "zIndex": 1,
            "data": {
              "type": "tm.Actor",
              "name": "User (Browser)",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "providesAuthentication": false,
              "threats": []
            }
          },
          {
            "position": {
              "x": 460,
              "y": 130
            },
            "size": {
              "width": 60,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Web Application"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "5a0f9eb5-142d-428d-b243-56fa6bce1643"
                },
                {
                  "group": "right",
                  "id": "dd029ea7-0e91-4677-af99-df6860f1bd9e"
                },
                {
                  "group": "bottom",
                  "id": "7a3da6a2-73bf-49cb-821e-fffc5790dbac"
                },
                {
                  "group": "left",
                  "id": "5654df49-a99d-4d1d-a813-15fdcec110e9"
                }
              ]
            },
            "id": "b6bd0551-c54c-4495-b737-1a13bcc08514",
            "zIndex": 2,
            "data": {
              "type": "tm.Process",
              "name": "Web Application",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": []
            }
          },
          {
            "position": {
              "x": 490,
              "y": 240
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Open Source Auth Component"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "5a0f9eb5-142d-428d-b243-56fa6bce1643"
                },
                {
                  "group": "right",
                  "id": "dd029ea7-0e91-4677-af99-df6860f1bd9e"
                },
                {
                  "group": "bottom",
                  "id": "7a3da6a2-73bf-49cb-821e-fffc5790dbac"
                },
                {
                  "group": "left",
                  "id": "5654df49-a99d-4d1d-a813-15fdcec110e9"
                }
              ]
            },
            "id": "4029ca0d-d6a2-44bf-8b08-bda92de9d486",
            "zIndex": 3,
            "data": {
              "type": "tm.Process",
              "name": "Open Source Auth Component",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "68c2c506-71ef-4e50-8352-9b45200acac8",
                  "title": "Open Source Component Vulnerability",
                  "status": "Open",
                  "severity": "Critical",
                  "type": "Elevation of privilege",
                  "description": "The open-source authentication component may contain known vulnerabilities that can be exploited to escalate privileges or bypass authentication.",
                  "mitigation": "Regularly monitor and patch the component. Perform third-party component audits. Restrict permissions based on least privilege.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 4,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 0,
                "tampering": 0,
                "repudiation": 0,
                "informationDisclosure": 0,
                "denialOfService": 0,
                "elevationOfPrivilege": 1
              }
            }
          },
          {
            "position": {
              "x": 860,
              "y": 120
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Database"
              },
              "topLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "a4b916a2-bc28-4e58-9aba-c237ebdbd5cd"
                },
                {
                  "group": "right",
                  "id": "4a807862-c684-4f5b-8f86-455018e7c003"
                },
                {
                  "group": "bottom",
                  "id": "c6c7fb62-fa3f-45c1-8649-67d8789dcc6c"
                },
                {
                  "group": "left",
                  "id": "66574bfd-7354-4252-9b49-5b1b216492ba"
                }
              ]
            },
            "id": "a467b414-19a0-40ae-85ae-a931737408cf",
            "zIndex": 4,
            "data": {
              "type": "tm.Store",
              "name": "Query User Credentials",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": []
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Credential Verification",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "Credential Verification"
            ],
            "id": "03ddf223-ada8-4965-a3b0-b20a6b28ca87",
            "source": {
              "cell": "b6bd0551-c54c-4495-b737-1a13bcc08514",
              "port": "7a3da6a2-73bf-49cb-821e-fffc5790dbac"
            },
            "target": {
              "cell": "4029ca0d-d6a2-44bf-8b08-bda92de9d486",
              "port": "5a0f9eb5-142d-428d-b243-56fa6bce1643"
            },
            "vertices": []
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Message-of-the-day & Comments Access",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "f9a5be23-ed31-4bc4-8f94-63e73494befd",
                  "title": "Message Disclosure via API",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "Message content or comments may be exposed to unauthorized users if access control is not enforced.",
                  "mitigation": "mplement proper access control. Ensure messages and comments are tied to authenticated sessions and user roles.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 5,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 0,
                "informationDisclosure": 1,
                "denialOfService": 0
              }
            },
            "labels": [
              "Message-of-the-day & Comments Access"
            ],
            "id": "34aaab5d-d759-413e-9063-35d7a046fc37",
            "source": {
              "cell": "b6bd0551-c54c-4495-b737-1a13bcc08514",
              "port": "dd029ea7-0e91-4677-af99-df6860f1bd9e"
            },
            "target": {
              "cell": "a467b414-19a0-40ae-85ae-a931737408cf",
              "port": "66574bfd-7354-4252-9b49-5b1b216492ba"
            },
            "vertices": [
              {
                "x": 660,
                "y": 160
              },
              {
                "x": 690,
                "y": 150
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Login Request",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "c9d5d37d-5dec-4cb0-b27a-d4bdbaa3e0ba",
                  "title": "Credential Tampering",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "The login request could be intercepted and modified to manipulate credentials before they reach the server.",
                  "mitigation": "Use HTTPS/TLS for secure transmission. Validate and sanitize all incoming data. Implement HMAC or digital signatures on transmitted requests.",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 3,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 0,
                "denialOfService": 0
              }
            },
            "labels": [
              "Login Request"
            ],
            "id": "ce20980e-af7c-473e-8fb5-b2cd67816237",
            "source": {
              "cell": "b6bd0551-c54c-4495-b737-1a13bcc08514",
              "port": "5654df49-a99d-4d1d-a813-15fdcec110e9"
            },
            "target": {
              "cell": "292d9e57-7f74-475d-b31a-206fb6a0e821",
              "port": "8f0e8f65-1a08-4547-815a-08be7d71e7df"
            },
            "vertices": [
              {
                "x": 360,
                "y": 140
              },
              {
                "x": 340,
                "y": 140
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Post Comment",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "8392f6ee-684b-4f65-8c1d-d090d9abd89b",
                  "title": "Comment Injection Attack",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "Users may submit malicious scripts or code in comments to tamper with page behavior (XSS attack).",
                  "mitigation": "Sanitize and validate all comment input. Encode output properly before rendering. Use Content Security Policy (CSP).",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 6,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 0,
                "denialOfService": 0
              }
            },
            "labels": [
              "Post Comment"
            ],
            "id": "b5167ea3-eed5-402f-9ea5-d577f4c0d896",
            "source": {
              "cell": "b6bd0551-c54c-4495-b737-1a13bcc08514",
              "port": "5654df49-a99d-4d1d-a813-15fdcec110e9"
            },
            "target": {
              "cell": "292d9e57-7f74-475d-b31a-206fb6a0e821",
              "port": "8f0e8f65-1a08-4547-815a-08be7d71e7df"
            },
            "vertices": [
              {
                "x": 330,
                "y": 180
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "Data Flow"
            ],
            "id": "f46eb548-b28c-42e8-b21a-c0d40840f094",
            "source": {
              "cell": "4029ca0d-d6a2-44bf-8b08-bda92de9d486",
              "port": "dd029ea7-0e91-4677-af99-df6860f1bd9e"
            },
            "target": {
              "cell": "a467b414-19a0-40ae-85ae-a931737408cf",
              "port": "66574bfd-7354-4252-9b49-5b1b216492ba"
            },
            "vertices": []
          }
        ],
        "description": "A data flow diagram for a message board web application including authentication, message retrieval, and comment submission."
      }
    ],
    "diagramTop": 1,
    "reviewer": "test",
    "threatTop": 6
  }
}